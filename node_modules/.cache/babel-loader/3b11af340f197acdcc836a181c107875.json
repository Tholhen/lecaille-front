{"ast":null,"code":"import _toConsumableArray from\"/Users/nicolas/Documents/Travail/Web Developper/3W Academy/Projet/site/lecaille-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/nicolas/Documents/Travail/Web Developper/3W Academy/Projet/site/lecaille-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{connect}from\"react-redux\";import{updateUser,updatePassword}from\"../../api/user\";import{getAllRequestsByCustomer,getAllRequestDetails}from\"../../api/requests\";import{convertDate}from\"../../utils/utils\";import{getOneUser}from\"../../api/user\";import{refreshUserInfos}from\"../../actions/user/userAction\";import{config}from\"../../config/config\";//Imports des composants de l'UI externes\nimport Header from\"../headers/header\";import HeaderPages from\"../headers/headerPages\";import Footer from\"../footer\";//Imports depuis la librairie MaterialUI\nimport{Button}from'@material-ui/core';import TextField from'@material-ui/core/TextField';import FormHelperText from'@material-ui/core/FormHelperText';import FormControl from'@material-ui/core/FormControl';import{makeStyles}from\"@material-ui/styles\";import AccountCircleIcon from'@material-ui/icons/AccountCircle';import MailIcon from'@material-ui/icons/Mail';import Snackbar from'@material-ui/core/Snackbar';import MuiAlert from'@material-ui/lab/Alert';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Profile=function Profile(props){var headerTitle=\"Profil\";var headerBreadcrumbs=[{value:\"Accueil\",link:\"/\"},{value:\"Profil\",link:null}];var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),firstName=_useState2[0],setFirstName=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),firstNameError=_useState4[0],setFirstNameError=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),firstNameErrorText=_useState6[0],setFirstNameErrorText=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),lastName=_useState8[0],setLastName=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),lastNameError=_useState10[0],setLastNameError=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),lastNameErrorText=_useState12[0],setLastNameErrorText=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),email=_useState14[0],setEmail=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),emailError=_useState16[0],setEmailError=_useState16[1];var _useState17=useState(\"\"),_useState18=_slicedToArray(_useState17,2),emailErrorText=_useState18[0],setEmailErrorText=_useState18[1];var _useState19=useState(\"\"),_useState20=_slicedToArray(_useState19,2),password=_useState20[0],setPassword=_useState20[1];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),passwordUpdated=_useState22[0],setPasswordUpdated=_useState22[1];var _useState23=useState(\"\"),_useState24=_slicedToArray(_useState23,2),phone=_useState24[0],setPhone=_useState24[1];var _useState25=useState(false),_useState26=_slicedToArray(_useState25,2),phoneError=_useState26[0],setPhoneError=_useState26[1];var _useState27=useState(\"\"),_useState28=_slicedToArray(_useState27,2),phoneErrorText=_useState28[0],setPhoneErrorText=_useState28[1];var _useState29=useState(\"\"),_useState30=_slicedToArray(_useState29,2),address=_useState30[0],setAddress=_useState30[1];var _useState31=useState(\"\"),_useState32=_slicedToArray(_useState31,2),zip=_useState32[0],setZip=_useState32[1];var _useState33=useState(\"\"),_useState34=_slicedToArray(_useState33,2),city=_useState34[0],setCity=_useState34[1];var _useState35=useState([]),_useState36=_slicedToArray(_useState35,2),displayedRequests=_useState36[0],setDisplayedRequests=_useState36[1];var _useState37=useState(false),_useState38=_slicedToArray(_useState37,2),snackBarOpened=_useState38[0],setSnackBarOpened=_useState38[1];var _useState39=useState(\"\"),_useState40=_slicedToArray(_useState39,2),snackBarSeverity=_useState40[0],setSnackBarSeverity=_useState40[1];var _useState41=useState(\"\"),_useState42=_slicedToArray(_useState41,2),successUpdateText=_useState42[0],setSuccessUpdateText=_useState42[1];//Définition des styles MaterialUI\nvar useStyles=makeStyles(function(theme){return{margin:{margin:theme.spacing(1)}};});var classes=useStyles();//A chaque modification du redux user\nuseEffect(function(){setFirstName(props.user.infos.first_name);setLastName(props.user.infos.last_name);setEmail(props.user.infos.email);setPhone(props.user.infos.phone);setAddress(props.user.infos.address);setZip(props.user.infos.zip);setCity(props.user.infos.city);getAllRequestsByCustomer(props.user.infos.id).then(function(requestsDB){loadRequestsDetails(requestsDB);});},[props.user]);// Au click sur le bouton envoyer\nvar onSubmit=function onSubmit(){globalVerify();};//Fonction de vérification de bonne saisie des informations\nvar globalVerify=function globalVerify(){if(!firstName){setFirstNameError(true);setFirstNameErrorText(\"Prénom non renseigné\");}else{setFirstNameError(false);setFirstNameErrorText(\"\");}if(!lastName){setLastNameError(true);setLastNameErrorText(\"Nom non renseigné\");}else{setLastNameError(false);setLastNameErrorText(\"\");}if(!email){setEmailError(true);setEmailErrorText(\"Adresse email non renseignée\");}else{if(!email.match(config.emailRegEx)){setEmailError(true);setEmailErrorText(\"Adresse email non valide\");}else{setEmailError(false);setEmailErrorText(\"\");}}if(password!==\"\"){setPasswordUpdated(true);}else{setPasswordUpdated(false);}if(!phone){setPhoneError(true);setPhoneErrorText(\"N° de téléphone non renseigné\");}else{if(!phone.match(config.phoneRegEx)){setPhoneError(true);setPhoneErrorText(\"N° de téléphone incorrect\");}else{setPhoneError(false);setPhoneErrorText(\"\");}}//Si tous les champs sont bons, on enregistre les modification apportées à l'utilisateur\nif(firstName&&lastName&&email&&phone&&phone.match(config.phoneRegEx)&&email.match(config.emailRegEx)){var datas={first_name:firstName,last_name:lastName,email:email,phone:phone,address:address,zip:zip,city:city};updateUser(datas,props.user.infos.id).then(function(responseUpdateUser){if(responseUpdateUser.data.status===200){if(passwordUpdated){var datasPassword={password:password};updatePassword(datasPassword,props.user.infos.id).then(function(responsePassword){if(responsePassword.data.status===200){endUpdateProcess(\"success\",\"Succès de la mise à jour de votre profil et du mot de passe\");}else{endUpdateProcess(\"error\",\"Erreur lors de la mise à jour du mot de passe\");}});}else{endUpdateProcess(\"success\",\"Succès de la mise à jour de votre profil\");}}else{endUpdateProcess(\"error\",\"Erreur lors de la mise à jour de votre profil\");}});}};var endUpdateProcess=function endUpdateProcess(result,message){setSnackBarSeverity(result);setSuccessUpdateText(message);openSnackbar();if(result===\"success\"){getOneUser(props.user.infos.id).then(function(user){props.refreshUserInfos(user);});}};//Fonctions de gestion de l'ouverture/fermeture de la snackbar\nvar closeSnackbar=function closeSnackbar(){setSnackBarOpened(false);};var openSnackbar=function openSnackbar(){setSnackBarOpened(true);};//Contruction de la liste des commandes passées à afficher\nvar loadRequestsDetails=function loadRequestsDetails(requests){var _loop=function _loop(i){var requestDetails=[];getAllRequestDetails(requests[i].id).then(function(requestLines){for(var j=0;j<requestLines.length;j++){requestDetails=[].concat(_toConsumableArray(requestDetails),[/*#__PURE__*/_jsxs(\"article\",{className:\"request-details-item\",children:[/*#__PURE__*/_jsx(\"section\",{className:\"request-details-item-pict\",children:/*#__PURE__*/_jsx(\"img\",{src:config.product_pict_url+requestLines[j].pict_url,alt:\"illustration\"+requestLines[j].id})}),/*#__PURE__*/_jsxs(\"section\",{className:\"request-details-item-infos\",children:[/*#__PURE__*/_jsx(\"p\",{children:requestLines[j].name}),/*#__PURE__*/_jsxs(\"p\",{children:[requestLines[j].quantity,\" g\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[requestLines[j].price,\" \\u20AC TTC\"]})]})]},requestLines[j].id)]);}setDisplayedRequests(function(displayedRequests){return[].concat(_toConsumableArray(displayedRequests),[/*#__PURE__*/_jsxs(\"article\",{className:\"profile-user-request-item\",children:[/*#__PURE__*/_jsxs(\"section\",{className:\"request-item-header\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"N\\xB0\",requests[i].request_number]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"du \",convertDate(requests[i].request_date)]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Statut : \",requests[i].preparation_status]})]}),/*#__PURE__*/_jsx(\"section\",{className:\"request-item-details\",children:requestDetails}),/*#__PURE__*/_jsxs(\"section\",{className:\"request-item-resume\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Total\"}),/*#__PURE__*/_jsxs(\"p\",{children:[requests[i].total_amount,\" \\u20AC TCC\"]})]})]},requests[i].id)]);});});};for(var i=0;i<requests.length;i++){_loop(i);}};//Fonction d'affichage des commandes de l'utilisateur\nvar showRequestsDetails=function showRequestsDetails(){return/*#__PURE__*/_jsx(\"section\",{className:\"profile-user-requests-container\",children:displayedRequests});};return/*#__PURE__*/_jsxs(\"section\",{className:\"root\",children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(HeaderPages,{headerTitle:headerTitle,headerBreadcrumbs:headerBreadcrumbs}),/*#__PURE__*/_jsxs(\"section\",{className:\"profile-container\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Mes informations\"}),/*#__PURE__*/_jsxs(\"section\",{className:\"profile-user-infos-container default-background-gradient\",children:[/*#__PURE__*/_jsxs(\"section\",{className:\"profile-user-informations\",children:[/*#__PURE__*/_jsxs(\"section\",{className:\"profile-header\",children:[/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(AccountCircleIcon,{})}),/*#__PURE__*/_jsx(\"p\",{className:\"profile-header-title\",children:\"Informations personnelles\"})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"profile-user-informations-content\",children:[/*#__PURE__*/_jsxs(FormControl,{error:true,className:classes.margin,children:[/*#__PURE__*/_jsx(TextField,{variant:\"filled\",label:\"Nom\",color:\"primary\",required:true,onChange:function onChange(e){setLastName(e.target.value);},error:lastNameError,value:lastName||\"\",InputLabelProps:{style:{color:\"#B4B4B4\"}},InputProps:{style:{color:\"#fff\"}}}),/*#__PURE__*/_jsx(FormHelperText,{children:lastNameErrorText})]}),/*#__PURE__*/_jsxs(FormControl,{error:true,className:classes.margin,children:[/*#__PURE__*/_jsx(TextField,{variant:\"filled\",label:\"Pr\\xE9nom\",color:\"primary\",required:true,onChange:function onChange(e){setFirstName(e.target.value);},error:firstNameError,value:firstName||\"\",InputLabelProps:{style:{color:\"#B4B4B4\"}},InputProps:{style:{color:\"#fff\"}}}),/*#__PURE__*/_jsx(FormHelperText,{children:firstNameErrorText})]}),/*#__PURE__*/_jsx(FormControl,{error:true,className:classes.margin,children:/*#__PURE__*/_jsx(TextField,{variant:\"filled\",label:\"Mot de passe\",color:\"primary\",onChange:function onChange(e){setPassword(e.target.value);e.target.value?setPasswordUpdated(true):setPasswordUpdated(false);},type:\"password\",defaultValue:\"\",InputLabelProps:{style:{color:\"#B4B4B4\"}},InputProps:{style:{color:\"#fff\"}}})})]})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"profile-user-contact\",children:[/*#__PURE__*/_jsxs(\"section\",{className:\"profile-header\",children:[/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(MailIcon,{})}),/*#__PURE__*/_jsx(\"p\",{className:\"profile-header-title\",children:\"Contact\"})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"profile-user-contact-content\",children:[/*#__PURE__*/_jsxs(FormControl,{error:true,className:classes.margin,children:[/*#__PURE__*/_jsx(TextField,{variant:\"filled\",label:\"Email\",color:\"primary\",required:true,onChange:function onChange(e){setEmail(e.target.value);},error:emailError,type:\"email\",value:email||\"\",InputLabelProps:{style:{color:\"#B4B4B4\"}},InputProps:{style:{color:\"#fff\"}}}),/*#__PURE__*/_jsx(FormHelperText,{children:emailErrorText})]}),/*#__PURE__*/_jsxs(FormControl,{error:true,className:classes.margin,children:[/*#__PURE__*/_jsx(TextField,{variant:\"filled\",label:\"T\\xE9l\\xE9phone\",color:\"primary\",required:true,error:phoneError,type:\"tel\",value:phone||\"\",onChange:function onChange(e){setPhone(e.target.value);},InputLabelProps:{style:{color:\"#B4B4B4\"}},InputProps:{style:{color:\"#fff\"}}}),/*#__PURE__*/_jsx(FormHelperText,{children:phoneErrorText})]}),/*#__PURE__*/_jsx(FormControl,{error:true,className:classes.margin,children:/*#__PURE__*/_jsx(TextField,{variant:\"filled\",label:\"Adresse\",color:\"primary\",onChange:function onChange(e){setAddress(e.target.value);},value:address||\"\",InputLabelProps:{style:{color:\"#B4B4B4\"}},InputProps:{style:{color:\"#fff\"}}})}),/*#__PURE__*/_jsx(FormControl,{error:true,className:classes.margin,children:/*#__PURE__*/_jsx(TextField,{variant:\"filled\",label:\"Code Postal\",color:\"primary\",onChange:function onChange(e){setZip(e.target.value);},value:zip||\"\",InputLabelProps:{style:{color:\"#B4B4B4\"}},InputProps:{style:{color:\"#fff\"}}})}),/*#__PURE__*/_jsx(FormControl,{error:true,className:classes.margin,children:/*#__PURE__*/_jsx(TextField,{variant:\"filled\",label:\"Ville\",color:\"primary\",onChange:function onChange(e){setCity(e.target.value);},value:city||\"\",InputLabelProps:{style:{color:\"#B4B4B4\"}},InputProps:{style:{color:\"#fff\"}}})})]}),/*#__PURE__*/_jsx(\"section\",{className:\"profile-submit-button\",children:/*#__PURE__*/_jsx(Button,{className:\"admin-user-edit-button\",color:\"primary\",variant:\"contained\",onClick:onSubmit,children:\"Modifier\"})}),/*#__PURE__*/_jsx(Snackbar,{open:snackBarOpened,autoHideDuration:6000,onClose:function onClose(e){closeSnackbar();},children:/*#__PURE__*/_jsx(MuiAlert,{onClose:function onClose(e){closeSnackbar();},severity:snackBarSeverity,children:successUpdateText})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-page-divider\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"Mes commandes\"}),showRequestsDetails()]}),/*#__PURE__*/_jsx(Footer,{})]});};var mapStateToProps=function mapStateToProps(store){return{};};var mapDispatchToProps={refreshUserInfos:refreshUserInfos};export default connect(mapStateToProps,mapDispatchToProps)(Profile);","map":{"version":3,"sources":["/Users/nicolas/Documents/Travail/Web Developper/3W Academy/Projet/site/lecaille-front/src/containers/user/profile.js"],"names":["React","useState","useEffect","connect","updateUser","updatePassword","getAllRequestsByCustomer","getAllRequestDetails","convertDate","getOneUser","refreshUserInfos","config","Header","HeaderPages","Footer","Button","TextField","FormHelperText","FormControl","makeStyles","AccountCircleIcon","MailIcon","Snackbar","MuiAlert","Profile","props","headerTitle","headerBreadcrumbs","value","link","firstName","setFirstName","firstNameError","setFirstNameError","firstNameErrorText","setFirstNameErrorText","lastName","setLastName","lastNameError","setLastNameError","lastNameErrorText","setLastNameErrorText","email","setEmail","emailError","setEmailError","emailErrorText","setEmailErrorText","password","setPassword","passwordUpdated","setPasswordUpdated","phone","setPhone","phoneError","setPhoneError","phoneErrorText","setPhoneErrorText","address","setAddress","zip","setZip","city","setCity","displayedRequests","setDisplayedRequests","snackBarOpened","setSnackBarOpened","snackBarSeverity","setSnackBarSeverity","successUpdateText","setSuccessUpdateText","useStyles","theme","margin","spacing","classes","user","infos","first_name","last_name","id","then","requestsDB","loadRequestsDetails","onSubmit","globalVerify","match","emailRegEx","phoneRegEx","datas","responseUpdateUser","data","status","datasPassword","responsePassword","endUpdateProcess","result","message","openSnackbar","closeSnackbar","requests","i","requestDetails","requestLines","j","length","product_pict_url","pict_url","name","quantity","price","request_number","request_date","preparation_status","total_amount","showRequestsDetails","e","target","style","color","mapStateToProps","store","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\"\nimport {connect} from \"react-redux\"\n\nimport {updateUser, updatePassword} from \"../../api/user\"\nimport {getAllRequestsByCustomer, getAllRequestDetails} from \"../../api/requests\"\nimport {convertDate} from \"../../utils/utils\"\nimport {getOneUser} from \"../../api/user\"\nimport {refreshUserInfos} from \"../../actions/user/userAction\"\nimport {config} from \"../../config/config\"\n\n//Imports des composants de l'UI externes\nimport Header from \"../headers/header\"\nimport HeaderPages from \"../headers/headerPages\"\nimport Footer from \"../footer\"\n\n//Imports depuis la librairie MaterialUI\nimport { Button } from '@material-ui/core';\nimport TextField from '@material-ui/core/TextField';\nimport FormHelperText from '@material-ui/core/FormHelperText';\nimport FormControl from '@material-ui/core/FormControl';\nimport {makeStyles } from \"@material-ui/styles\";\nimport AccountCircleIcon from '@material-ui/icons/AccountCircle';\nimport MailIcon from '@material-ui/icons/Mail'\nimport Snackbar from '@material-ui/core/Snackbar';\nimport MuiAlert from '@material-ui/lab/Alert';\n\nconst Profile = (props) => {\n\n    const headerTitle = \"Profil\"\n    const headerBreadcrumbs = [{value: \"Accueil\", link:\"/\"}, {value: \"Profil\", link:null}]\n\n    const [firstName, setFirstName] = useState(\"\")\n    const [firstNameError, setFirstNameError] = useState(false)\n    const [firstNameErrorText, setFirstNameErrorText] = useState(\"\")\n    \n\n    const [lastName, setLastName] = useState(\"\")\n    const [lastNameError, setLastNameError] = useState(false)\n    const [lastNameErrorText, setLastNameErrorText] = useState(\"\")\n\n    const [email, setEmail] = useState(\"\")\n    const [emailError, setEmailError] = useState(false)\n    const [emailErrorText, setEmailErrorText] = useState(\"\")\n\n    const [password, setPassword] = useState(\"\")\n    const [passwordUpdated, setPasswordUpdated] = useState(false)\n\n    const [phone, setPhone] = useState(\"\")\n    const [phoneError, setPhoneError] = useState(false)\n    const [phoneErrorText, setPhoneErrorText] = useState(\"\")\n\n    const [address, setAddress] = useState(\"\")\n    const [zip, setZip] = useState(\"\")\n    const [city, setCity] = useState(\"\")\n\n    const [displayedRequests, setDisplayedRequests] = useState([])\n\n    const [snackBarOpened, setSnackBarOpened] = useState(false)\n    const [snackBarSeverity, setSnackBarSeverity] = useState(\"\")\n    const [successUpdateText, setSuccessUpdateText] = useState(\"\")\n\n    //Définition des styles MaterialUI\n    const useStyles = makeStyles((theme) => ({\n        margin: {\n            margin: theme.spacing(1)\n        }\n        }));\n        \n    const classes = useStyles();\n\n    //A chaque modification du redux user\n    useEffect(() => {\n        setFirstName(props.user.infos.first_name)\n        setLastName(props.user.infos.last_name)\n        setEmail(props.user.infos.email)\n        setPhone(props.user.infos.phone)\n        setAddress(props.user.infos.address)\n        setZip(props.user.infos.zip)\n        setCity(props.user.infos.city)\n\n        getAllRequestsByCustomer(props.user.infos.id)\n        .then((requestsDB) => {\n            loadRequestsDetails(requestsDB)\n        })\n        \n    }, [props.user])\n\n    // Au click sur le bouton envoyer\n    const onSubmit = () => {\n        globalVerify()\n    }\n\n    //Fonction de vérification de bonne saisie des informations\n    const globalVerify = () => {\n\n        if(!firstName){\n            setFirstNameError(true)\n            setFirstNameErrorText(\"Prénom non renseigné\")\n        }\n        else {\n            setFirstNameError(false)\n            setFirstNameErrorText(\"\")\n        }\n\n        if(!lastName){\n            setLastNameError(true)\n            setLastNameErrorText(\"Nom non renseigné\")\n        }\n        else {\n            setLastNameError(false)\n            setLastNameErrorText(\"\")\n        }\n        if(!email){\n            setEmailError(true)\n            setEmailErrorText(\"Adresse email non renseignée\")\n        }\n        else {\n            if(!email.match(config.emailRegEx)){\n                setEmailError(true)\n                setEmailErrorText(\"Adresse email non valide\")\n            }\n            else {\n                setEmailError(false)\n                setEmailErrorText(\"\")\n            }\n        }\n        if(password !== \"\"){\n            setPasswordUpdated(true)\n        }\n        else {\n            setPasswordUpdated(false)\n        }\n        if(!phone){\n            setPhoneError(true)\n            setPhoneErrorText(\"N° de téléphone non renseigné\")\n        }\n        else{\n            if(!phone.match(config.phoneRegEx)){\n                setPhoneError(true)\n                setPhoneErrorText(\"N° de téléphone incorrect\")\n            }\n            else {\n                setPhoneError(false)\n                setPhoneErrorText(\"\")\n            }\n        }\n\n        //Si tous les champs sont bons, on enregistre les modification apportées à l'utilisateur\n        if(firstName && lastName && email && phone && phone.match(config.phoneRegEx) && email.match(config.emailRegEx)){\n            \n            let datas = {\n                first_name: firstName,\n                last_name: lastName,\n                email: email,\n                phone: phone,\n                address: address,\n                zip: zip,\n                city: city\n            }    \n\n            updateUser(datas, props.user.infos.id)\n            .then(responseUpdateUser => {\n                if(responseUpdateUser.data.status === 200){\n                    \n                    if(passwordUpdated){\n                        let datasPassword = {\n                            password: password\n                        }\n                        updatePassword(datasPassword, props.user.infos.id)\n                        .then(responsePassword => { \n                            if(responsePassword.data.status === 200){\n                                endUpdateProcess(\"success\",\"Succès de la mise à jour de votre profil et du mot de passe\")\n                            }\n                            else {\n                                endUpdateProcess(\"error\",\"Erreur lors de la mise à jour du mot de passe\")\n                            }\n                        })\n                    }\n                    else{\n                        endUpdateProcess(\"success\",\"Succès de la mise à jour de votre profil\")\n                    }\n                }\n                else {\n                    endUpdateProcess(\"error\",\"Erreur lors de la mise à jour de votre profil\")\n                }\n            })         \n        }\n    }\n\n    const endUpdateProcess = (result, message) => {\n        setSnackBarSeverity(result)\n        setSuccessUpdateText(message)\n        openSnackbar()\n        if(result===\"success\"){\n            getOneUser(props.user.infos.id)\n            .then(user => {\n                props.refreshUserInfos(user)\n            })  \n        }\n        \n    }\n\n    //Fonctions de gestion de l'ouverture/fermeture de la snackbar\n    const closeSnackbar = () => {\n        setSnackBarOpened(false)\n    }\n\n    const openSnackbar = () => {\n        setSnackBarOpened(true)\n    }\n\n    //Contruction de la liste des commandes passées à afficher\n    const loadRequestsDetails = (requests) => {\n        for(let i = 0; i < requests.length; i++){\n            let requestDetails = []\n            getAllRequestDetails(requests[i].id)\n            .then((requestLines) => {\n                for(let j = 0; j < requestLines.length; j++){\n                    requestDetails = [...requestDetails,\n                        <article key={requestLines[j].id} className=\"request-details-item\">\n                            <section className=\"request-details-item-pict\">\n                                <img src={config.product_pict_url + requestLines[j].pict_url} alt={\"illustration\"+requestLines[j].id}/>\n                            </section>\n                            <section className=\"request-details-item-infos\">\n                                <p>{requestLines[j].name}</p>\n                                <p>{requestLines[j].quantity} g</p>\n                                <p>{requestLines[j].price} € TTC</p>\n                            </section>\n                        </article>]\n                }\n\n                setDisplayedRequests(displayedRequests => [...displayedRequests,\n                    <article key={requests[i].id} className=\"profile-user-request-item\">\n                        <section className=\"request-item-header\">\n                            <p>N°{requests[i].request_number}</p>\n                            <p>du {convertDate(requests[i].request_date)}</p>\n                            <p>Statut : {requests[i].preparation_status}</p>\n                        </section>\n                        <section className=\"request-item-details\">\n                            {requestDetails}\n                        </section>\n                        <section className=\"request-item-resume\">\n                            <p>Total</p>\n                            <p>{requests[i].total_amount} € TCC</p>\n                        </section>\n                    </article>])\n            })\n        }\n    }\n\n    //Fonction d'affichage des commandes de l'utilisateur\n    const showRequestsDetails = () => {\n        return (\n        <section className=\"profile-user-requests-container\">\n                    {displayedRequests}\n        </section>)\n    }\n\n    return(\n        <section className=\"root\">\n            <Header />\n            <HeaderPages headerTitle={headerTitle} headerBreadcrumbs={headerBreadcrumbs}/>\n            \n            <section className=\"profile-container\">\n                <h4>Mes informations</h4>\n                <section className=\"profile-user-infos-container default-background-gradient\">\n                    <section className=\"profile-user-informations\">\n\n                        <section className=\"profile-header\">\n                            <p><AccountCircleIcon /></p>\n                            <p className=\"profile-header-title\">Informations personnelles</p>\n                        </section>\n                        <section className=\"profile-user-informations-content\">\n                            <FormControl error className={classes.margin}>\n                                <TextField variant=\"filled\" label=\"Nom\" color=\"primary\" required onChange={(e) => {setLastName(e.target.value)}} error={lastNameError} value={lastName || \"\"} \n                                InputLabelProps={{style : {color : \"#B4B4B4\"}}}\n                                InputProps={{style : {color : \"#fff\"}}}/>\n                                <FormHelperText>{lastNameErrorText}</FormHelperText>\n                            </FormControl>\n\n                            <FormControl error className={classes.margin}>\n                                <TextField variant=\"filled\" label=\"Prénom\" color=\"primary\"  required onChange={(e) => {setFirstName(e.target.value)}} error={firstNameError} value={firstName || \"\"}\n                                InputLabelProps={{style : {color : \"#B4B4B4\"}}}\n                                InputProps={{style : {color : \"#fff\"}}}/>\n                                <FormHelperText>{firstNameErrorText}</FormHelperText>\n                            </FormControl>\n\n                            <FormControl error className={classes.margin}>\n                                <TextField variant=\"filled\" label=\"Mot de passe\" color=\"primary\" onChange={(e) => {setPassword(e.target.value)\n                                e.target.value ? setPasswordUpdated(true) : setPasswordUpdated(false)}} type=\"password\" defaultValue=\"\"\n                                InputLabelProps={{style : {color : \"#B4B4B4\"}}}\n                                InputProps={{style : {color : \"#fff\"}}}/>\n                            </FormControl>\n                        </section>\n                    </section>\n                    \n                    <section className=\"profile-user-contact\">\n                            <section className=\"profile-header\">\n                                <p><MailIcon /></p>\n                                <p className=\"profile-header-title\">Contact</p>\n                            </section>\n                            <section className=\"profile-user-contact-content\">\n                                \n                                    <FormControl error className={classes.margin} >\n                                        <TextField variant=\"filled\" label=\"Email\" color=\"primary\" required onChange={(e) => {setEmail(e.target.value)}} error={emailError} type=\"email\" value={email || \"\"}\n                                        InputLabelProps={{style : {color : \"#B4B4B4\"}}}\n                                        InputProps={{style : {color : \"#fff\"}}}/>\n                                        <FormHelperText>{emailErrorText}</FormHelperText>\n                                    </FormControl>\n\n                                    <FormControl error className={classes.margin}>\n                                        <TextField variant=\"filled\" label=\"Téléphone\" color=\"primary\" required  error={phoneError} type=\"tel\" value={phone || \"\"\n                                        } onChange={(e) => {setPhone(e.target.value)}} \n                                        InputLabelProps={{style : {color : \"#B4B4B4\"}}}\n                                        InputProps={{style : {color : \"#fff\"}}}/>\n                                        <FormHelperText>{phoneErrorText}</FormHelperText>\n                                    </FormControl>\n\n                                    <FormControl error className={classes.margin}>\n                                        <TextField variant=\"filled\" label=\"Adresse\" color=\"primary\" onChange={(e) => {setAddress(e.target.value)}} value={address || \"\"}\n                                        InputLabelProps={{style : {color : \"#B4B4B4\"}}}\n                                        InputProps={{style : {color : \"#fff\"}}}/>\n                                    </FormControl>\n\n                                    <FormControl error className={classes.margin}>\n                                        <TextField variant=\"filled\" label=\"Code Postal\" color=\"primary\" onChange={(e) => {setZip(e.target.value)}} value={zip || \"\"}\n                                        InputLabelProps={{style : {color : \"#B4B4B4\"}}}\n                                        InputProps={{style : {color : \"#fff\"}}}/>\n                                    </FormControl>\n\n                                    <FormControl error className={classes.margin}>\n                                        <TextField variant=\"filled\" label=\"Ville\" color=\"primary\" onChange={(e) => {setCity(e.target.value)}} value={city || \"\"}\n                                        InputLabelProps={{style : {color : \"#B4B4B4\"}}}\n                                        InputProps={{style : {color : \"#fff\"}}}/>\n                                    </FormControl>\n\n                                    \n                            </section>\n                            <section className=\"profile-submit-button\">\n                                <Button className=\"admin-user-edit-button\" color=\"primary\" variant=\"contained\" onClick={onSubmit}>Modifier</Button>\n                            </section>\n                            <Snackbar open={snackBarOpened} autoHideDuration={6000} onClose={(e) => {closeSnackbar()}}>\n                                <MuiAlert onClose={(e) => {closeSnackbar()}} severity={snackBarSeverity}>{successUpdateText}</MuiAlert>\n                            </Snackbar>\n                    </section>      \n                </section>\n                <div className=\"profile-page-divider\"></div>\n                <h4>Mes commandes</h4>\n                {showRequestsDetails()}\n            </section>\n            <Footer />\n        </section>\n    )\n}\n\nconst mapStateToProps = (store) => {\n    return {\n\n    }\n\n}\n\nconst mapDispatchToProps = {\n    refreshUserInfos\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Profile)"]},"metadata":{},"sourceType":"module"}