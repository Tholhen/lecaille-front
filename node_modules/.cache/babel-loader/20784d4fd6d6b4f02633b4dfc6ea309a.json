{"ast":null,"code":"import _slicedToArray from\"/Users/nicolas/Documents/Travail/Web Developper/3W Academy/Projet/site/lecaille-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{connect}from\"react-redux\";import{saveShopOpinion,saveShopOpinionPict}from\"../api/shopOpinions\";import Dialog from'@material-ui/core/Dialog';import DialogActions from'@material-ui/core/DialogActions';import DialogContent from'@material-ui/core/DialogContent';import DialogTitle from'@material-ui/core/DialogTitle';import{Button}from'@material-ui/core';import TextField from'@material-ui/core/TextField';import FormHelperText from'@material-ui/core/FormHelperText';import FormControl from'@material-ui/core/FormControl';import{makeStyles}from\"@material-ui/styles\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ShopOpinionPopUp=function ShopOpinionPopUp(props){//Définition des variables\nvar _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),opinion=_useState2[0],setOpinion=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),opinionError=_useState4[0],setOpinionError=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),opinionErrorMsg=_useState6[0],setOpinionErrorMsg=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),selectedFile=_useState8[0],setSelectedFile=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),filePreview=_useState10[0],setFilePreview=_useState10[1];//Définition des styles MaterialUI\nvar useStyles=makeStyles(function(theme){return{margin:{marginTop:theme.spacing(2)}};});var classes=useStyles();var onSubmit=function onSubmit(){if(!opinion){setOpinionError(true);setOpinionErrorMsg(\"Veuillez saisir votre message\");}else{setOpinionError(false);setOpinionErrorMsg(\"\");}if(opinion){var datas={id_user:props.user.infos.id,comment:opinion,pict_url:\"\"};if(selectedFile){saveShopOpinionPict(selectedFile).then(function(response){datas.pict_url=response.data.url;saveShopOpinion(datas);props.closeShopOpinionPopUp();props.openShopOpinionSnackbar();});}else{saveShopOpinion(datas);props.closeShopOpinionPopUp();props.openShopOpinionSnackbar();}}};return/*#__PURE__*/_jsxs(Dialog,{open:props.opened,onClose:function onClose(e){props.closeShopOpinionPopUp();},children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"Votre avis compte pour nous !\"}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsxs(\"form\",{className:\"shop-opinion-popup-form\",children:[/*#__PURE__*/_jsxs(FormControl,{error:true,children:[/*#__PURE__*/_jsx(TextField,{variant:\"filled\",label:\"Avis\",required:true,multiline:true,rows:10,error:opinionError,onChange:function onChange(e){setOpinion(e.target.value);}}),/*#__PURE__*/_jsx(FormHelperText,{children:opinionErrorMsg})]}),/*#__PURE__*/_jsxs(FormControl,{className:classes.margin,children:[/*#__PURE__*/_jsx(\"input\",{accept:\"images/*\",style:{display:'none'},id:\"file-select\",type:\"file\",onChange:function onChange(e){setSelectedFile(e.target.files[0]);if(e.target.files.length>0){setFilePreview(URL.createObjectURL(e.target.files[0]));}else{setFilePreview(\"\");}}}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"file-select\",children:/*#__PURE__*/_jsx(Button,{color:\"primary\",component:\"span\",children:\"Ajouter une photo\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"shop-opinion-popup-preview\",children:[/*#__PURE__*/_jsx(\"img\",{src:filePreview,alt:\"Pr\\xE9visualisation du fichier\"}),selectedFile&&selectedFile.name]})]})]})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:function onClick(e){props.closeShopOpinionPopUp();},color:\"primary\",children:\"Annuler\"}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(e){onSubmit();},color:\"primary\",variant:\"contained\",children:\"Envoyer\"})]})]});};var mapStateToProps=function mapStateToProps(store){return{user:store.user};};var mapDispatchToProps={};export default connect(mapStateToProps,mapDispatchToProps)(ShopOpinionPopUp);","map":{"version":3,"sources":["/Users/nicolas/Documents/Travail/Web Developper/3W Academy/Projet/site/lecaille-front/src/components/shopOpinionPopUp.js"],"names":["React","useState","connect","saveShopOpinion","saveShopOpinionPict","Dialog","DialogActions","DialogContent","DialogTitle","Button","TextField","FormHelperText","FormControl","makeStyles","ShopOpinionPopUp","props","opinion","setOpinion","opinionError","setOpinionError","opinionErrorMsg","setOpinionErrorMsg","selectedFile","setSelectedFile","filePreview","setFilePreview","useStyles","theme","margin","marginTop","spacing","classes","onSubmit","datas","id_user","user","infos","id","comment","pict_url","then","response","data","url","closeShopOpinionPopUp","openShopOpinionSnackbar","opened","e","target","value","display","files","length","URL","createObjectURL","name","mapStateToProps","store","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, {useState} from 'react'\nimport {connect} from \"react-redux\"\n\nimport {saveShopOpinion, saveShopOpinionPict} from \"../api/shopOpinions\"\n\n\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport { Button } from '@material-ui/core';\nimport TextField from '@material-ui/core/TextField';\nimport FormHelperText from '@material-ui/core/FormHelperText';\nimport FormControl from '@material-ui/core/FormControl';\nimport {makeStyles } from \"@material-ui/styles\";\n\n\n\nconst ShopOpinionPopUp = (props) => {\n\n    //Définition des variables\n    const [opinion, setOpinion] = useState(\"\")\n    const [opinionError, setOpinionError] = useState(false)\n    const [opinionErrorMsg, setOpinionErrorMsg] = useState(\"\")\n\n    const [selectedFile, setSelectedFile] = useState(\"\")\n    const [filePreview, setFilePreview] = useState(\"\")\n\n    //Définition des styles MaterialUI\n    const useStyles = makeStyles((theme) => ({\n        margin:{\n            marginTop: theme.spacing(2)\n        }\n        }));\n        \n    const classes = useStyles();\n\n    const onSubmit = () =>{\n        \n       if(!opinion){\n           setOpinionError(true)\n           setOpinionErrorMsg(\"Veuillez saisir votre message\")\n       }\n       else{\n            setOpinionError(false)\n            setOpinionErrorMsg(\"\")\n       }\n\n       \n       if(opinion){\n            let datas = {\n                id_user: props.user.infos.id,\n                comment: opinion,\n                pict_url:\"\"\n            }\n\n            if(selectedFile){\n                saveShopOpinionPict(selectedFile)\n                .then(response => {\n                    datas.pict_url = response.data.url\n                    saveShopOpinion(datas)\n                    props.closeShopOpinionPopUp()\n                    props.openShopOpinionSnackbar()\n                })\n                \n            } else {\n                saveShopOpinion(datas)\n                props.closeShopOpinionPopUp()\n                props.openShopOpinionSnackbar()\n            }\n       }\n    }\n\n    return(\n        <Dialog\n            open={props.opened}\n            onClose={(e) => {props.closeShopOpinionPopUp()}}\n        >\n            <DialogTitle>Votre avis compte pour nous !</DialogTitle>\n            <DialogContent>\n                <form className=\"shop-opinion-popup-form\">\n                    <FormControl error>\n                    <TextField variant=\"filled\" \n                                label=\"Avis\"\n                                required\n                                multiline rows={10}\n                                error={opinionError}\n                                onChange={(e) => {setOpinion(e.target.value)}}/>\n                        <FormHelperText>{opinionErrorMsg}</FormHelperText>\n                    </FormControl>\n\n                    <FormControl className={classes.margin}>\n                        <input \n                        accept=\"images/*\"\n                        style={{display: 'none'}}\n                        id=\"file-select\"\n                        type=\"file\"\n                        onChange={(e) => {setSelectedFile(e.target.files[0])\n                                            if(e.target.files.length > 0) {\n                                            setFilePreview(URL.createObjectURL(e.target.files[0]))\n                                            }\n                                            else {\n                                            setFilePreview(\"\")\n                                        }\n                                            }}\n                        />\n                        <label htmlFor=\"file-select\">\n                            <Button color=\"primary\" component=\"span\">Ajouter une photo</Button>\n                        </label>\n                        <div className=\"shop-opinion-popup-preview\">\n                            <img src={filePreview} alt=\"Prévisualisation du fichier\"/>\n                            {selectedFile && selectedFile.name}\n                        </div>\n                    </FormControl>\n                    \n                </form>\n            </DialogContent>\n            <DialogActions>\n            <Button onClick={(e) => {props.closeShopOpinionPopUp()}} color=\"primary\">\n                Annuler\n            </Button>\n            <Button onClick={(e) => {onSubmit()}} color=\"primary\" variant=\"contained\">\n                Envoyer\n            </Button>\n            </DialogActions>\n        </Dialog>\n    )\n}\n\nconst mapStateToProps = (store) => {\n    return {\n        user: store.user\n    }\n}\n\nconst mapDispatchToProps = {\n\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ShopOpinionPopUp)"]},"metadata":{},"sourceType":"module"}