{"ast":null,"code":"import _slicedToArray from\"/Users/nicolas/Documents/Travail/Web Developper/3W Academy/Projet/site/lecaille-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{getOneUser,updateUser,updatePassword,updateUserRole,getAllRoles}from\"../../api/user\";import{config}from\"../../config/config\";//Imports des composants de l'UI externes\nimport Header from\"../headers/header\";import HeaderPages from\"../headers/headerPages\";import Footer from\"../footer\";import AdminMenu from\"../../components/adminMenu\";//Imports depuis la librairie MaterialUI\nimport{Button}from'@material-ui/core';import TextField from'@material-ui/core/TextField';import FormHelperText from'@material-ui/core/FormHelperText';import FormControl from'@material-ui/core/FormControl';import InputLabel from'@material-ui/core/InputLabel';import NativeSelect from'@material-ui/core/NativeSelect';import{makeStyles}from\"@material-ui/styles\";import AccountCircleIcon from'@material-ui/icons/AccountCircle';import MailIcon from'@material-ui/icons/Mail';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AdminUserEdit=function AdminUserEdit(props){var headerTitle=\"Administration\";var headerBreadcrumbs=[{value:\"Accueil\",link:\"/\"},{value:\"Administration\",link:\"/admin\"},{value:\"Utilisateurs\",link:\"/admin/users\"},{value:\"Edition\",link:null}];var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),firstName=_useState2[0],setFirstName=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),firstNameError=_useState4[0],setFirstNameError=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),firstNameErrorText=_useState6[0],setFirstNameErrorText=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),lastName=_useState8[0],setLastName=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),lastNameError=_useState10[0],setLastNameError=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),lastNameErrorText=_useState12[0],setLastNameErrorText=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),email=_useState14[0],setEmail=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),emailError=_useState16[0],setEmailError=_useState16[1];var _useState17=useState(\"\"),_useState18=_slicedToArray(_useState17,2),emailErrorText=_useState18[0],setEmailErrorText=_useState18[1];var _useState19=useState(\"\"),_useState20=_slicedToArray(_useState19,2),password=_useState20[0],setPassword=_useState20[1];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),passwordUpdated=_useState22[0],setPasswordUpdated=_useState22[1];var _useState23=useState(\"\"),_useState24=_slicedToArray(_useState23,2),phone=_useState24[0],setPhone=_useState24[1];var _useState25=useState(false),_useState26=_slicedToArray(_useState25,2),phoneError=_useState26[0],setPhoneError=_useState26[1];var _useState27=useState(\"\"),_useState28=_slicedToArray(_useState27,2),phoneErrorText=_useState28[0],setPhoneErrorText=_useState28[1];var _useState29=useState(\"\"),_useState30=_slicedToArray(_useState29,2),address=_useState30[0],setAddress=_useState30[1];var _useState31=useState(\"\"),_useState32=_slicedToArray(_useState31,2),zip=_useState32[0],setZip=_useState32[1];var _useState33=useState(\"\"),_useState34=_slicedToArray(_useState33,2),city=_useState34[0],setCity=_useState34[1];var _useState35=useState(\"\"),_useState36=_slicedToArray(_useState35,2),idSelectedRole=_useState36[0],setIdSelectedRole=_useState36[1];var _useState37=useState([]),_useState38=_slicedToArray(_useState37,2),roles=_useState38[0],setRoles=_useState38[1];var _useState39=useState(0),_useState40=_slicedToArray(_useState39,2),newRole=_useState40[0],setNewRole=_useState40[1];//Définition du style MaterialUI\nvar useStyles=makeStyles(function(theme){return{margin:{margin:theme.spacing(1),width:\"90%\"}};});var classes=useStyles();useEffect(function(){getOneUser(props.match.params.id).then(function(user){setFirstName(user.first_name);setLastName(user.last_name);setEmail(user.email);setPhone(user.phone);setAddress(user.address);setZip(user.zip);setCity(user.city);setIdSelectedRole(user.id_role);setNewRole(user.id_role);});getAllRoles().then(function(rolesDB){setRoles(rolesDB.data.result);});},[props.match.params.id]);var globalVerify=function globalVerify(){if(!firstName){setFirstNameError(true);setFirstNameErrorText(\"Prénom non renseigné\");}else{setFirstNameError(false);setFirstNameErrorText(\"\");}if(!lastName){setLastNameError(true);setLastNameErrorText(\"Nom non renseigné\");}else{setLastNameError(false);setLastNameErrorText(\"\");}if(!email){setEmailError(true);setEmailErrorText(\"Adresse email non renseignée\");}else{if(!email.match(config.emailRegEx)){setEmailError(true);setEmailErrorText(\"Adresse email non valide\");}else{setEmailError(false);setEmailErrorText(\"\");}}if(password!==\"\"){setPasswordUpdated(true);}else{setPasswordUpdated(false);}if(!phone){setPhoneError(true);setPhoneErrorText(\"N° de téléphone non renseigné\");}else{if(!phone.match(config.phoneRegEx)){setPhoneError(true);setPhoneErrorText(\"N° de téléphone incorrect\");}else{setPhoneError(false);setPhoneErrorText(\"\");}}//Si tous les champs sont bons, on enregistre l'utilisateur\nif(firstName&&lastName&&email&&phone&&phone.match(config.phoneRegEx)&&email.match(config.emailRegEx)){var datas={first_name:firstName,last_name:lastName,email:email,phone:phone,address:address,zip:zip,city:city};updateUser(datas,props.match.params.id).then(function(responseUpdateUser){if(responseUpdateUser.data.status===200){console.log(\"Succès de la mise à jour utilisateur\");if(passwordUpdated){var datasPassword={password:password};updatePassword(datasPassword,props.match.params.id).then(function(responsePassword){if(responsePassword.data.status===200){console.log(\"Succès de la mise à jour du mot de passe\");}else{console.log(\"Erreur lors de la mise à jour du mot de passe\");}});}if(parseInt(newRole)!==idSelectedRole){var _datas={id_role:newRole};updateUserRole(_datas,props.match.params.id).then(function(responseRole){if(responseRole.status===200){console.log(\"Succès de la mise à jour du rôle\");}else{console.log(\"Erreur lors de la mise à jour du rôle\");}});}}else{console.log(\"Erreur lors de la mise à jour de l'utilisateur\");}});}};var onSubmit=function onSubmit(){globalVerify();};return/*#__PURE__*/_jsxs(\"section\",{className:\"root\",children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(HeaderPages,{headerTitle:headerTitle,headerBreadcrumbs:headerBreadcrumbs}),/*#__PURE__*/_jsxs(\"section\",{className:\"admin-container\",children:[/*#__PURE__*/_jsx(AdminMenu,{}),/*#__PURE__*/_jsxs(\"section\",{className:\"admin-content\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Edition d'un utilisateur\"}),/*#__PURE__*/_jsx(\"section\",{className:\"user-edit-container\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"admin-user-edit\",children:[/*#__PURE__*/_jsxs(\"section\",{className:\"user-edit-informations\",children:[/*#__PURE__*/_jsxs(\"section\",{className:\"user-edit-header\",children:[/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(AccountCircleIcon,{})}),/*#__PURE__*/_jsx(\"p\",{className:\"admin-content-section-title\",children:\"Informations personnelles\"})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"user-edit-informations-content\",children:[/*#__PURE__*/_jsxs(FormControl,{error:true,className:classes.margin,children:[/*#__PURE__*/_jsx(TextField,{label:\"Nom\",color:\"primary\",required:true,onChange:function onChange(e){setLastName(e.target.value);},error:lastNameError,value:lastName||\"\",variant:\"filled\"}),/*#__PURE__*/_jsx(FormHelperText,{children:lastNameErrorText})]}),/*#__PURE__*/_jsxs(FormControl,{error:true,className:classes.margin,children:[/*#__PURE__*/_jsx(TextField,{label:\"Pr\\xE9nom\",color:\"primary\",required:true,onChange:function onChange(e){setFirstName(e.target.value);},error:firstNameError,value:firstName||\"\",variant:\"filled\"}),/*#__PURE__*/_jsx(FormHelperText,{children:firstNameErrorText})]}),/*#__PURE__*/_jsx(FormControl,{error:true,className:classes.margin,children:/*#__PURE__*/_jsx(TextField,{label:\"Mot de passe\",color:\"primary\",onChange:function onChange(e){setPassword(e.target.value);e.target.value?setPasswordUpdated(true):setPasswordUpdated(false);},type:\"password\",defaultValue:\"\",variant:\"filled\"})}),/*#__PURE__*/_jsxs(FormControl,{className:classes.margin,children:[/*#__PURE__*/_jsx(InputLabel,{shrink:true,children:\"R\\xF4le\"}),/*#__PURE__*/_jsx(NativeSelect,{name:\"role\",className:\"\",textfieldprops:{label:\"Label\",InputLabelProps:{shrink:true}},onChange:function onChange(e){setNewRole(e.target.value);},children:roles.map(function(role){return/*#__PURE__*/_jsx(\"option\",{value:role.id,selected:idSelectedRole===role.id?true:false,children:role.label},role.id);})})]})]})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"user-edit-contact\",children:[/*#__PURE__*/_jsxs(\"section\",{className:\"user-edit-header\",children:[/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(MailIcon,{})}),/*#__PURE__*/_jsx(\"p\",{className:\"admin-content-section-title\",children:\"Contact\"})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"user-edit-contact-content\",children:[/*#__PURE__*/_jsxs(FormControl,{error:true,className:classes.margin,children:[/*#__PURE__*/_jsx(TextField,{label:\"Email\",color:\"primary\",required:true,onChange:function onChange(e){setEmail(e.target.value);},error:emailError,type:\"email\",value:email||\"\",variant:\"filled\"}),/*#__PURE__*/_jsx(FormHelperText,{children:emailErrorText})]}),/*#__PURE__*/_jsxs(FormControl,{error:true,className:classes.margin,children:[/*#__PURE__*/_jsx(TextField,{label:\"T\\xE9l\\xE9phone\",color:\"primary\",required:true,error:phoneError,type:\"tel\",value:phone||\"\",onChange:function onChange(e){setPhone(e.target.value);},variant:\"filled\"}),/*#__PURE__*/_jsx(FormHelperText,{children:phoneErrorText})]}),/*#__PURE__*/_jsx(FormControl,{error:true,className:classes.margin,children:/*#__PURE__*/_jsx(TextField,{label:\"Adresse\",color:\"primary\",onChange:function onChange(e){setAddress(e.target.value);},value:address||\"\",variant:\"filled\"})}),/*#__PURE__*/_jsx(FormControl,{error:true,className:classes.margin,children:/*#__PURE__*/_jsx(TextField,{label:\"Code Postal\",color:\"primary\",onChange:function onChange(e){setZip(e.target.value);},value:zip||\"\",variant:\"filled\"})}),/*#__PURE__*/_jsx(FormControl,{error:true,className:classes.margin,children:/*#__PURE__*/_jsx(TextField,{label:\"Ville\",color:\"primary\",onChange:function onChange(e){setCity(e.target.value);},value:city||\"\",variant:\"filled\"})})]}),/*#__PURE__*/_jsx(Button,{className:\"admin-user-edit-button\",color:\"primary\",variant:\"contained\",onClick:function onClick(e){onSubmit();},children:\"Envoyer\"})]})]})})]})]}),/*#__PURE__*/_jsx(Footer,{})]});};export default AdminUserEdit;","map":{"version":3,"sources":["/Users/nicolas/Documents/Travail/Web Developper/3W Academy/Projet/site/lecaille-front/src/containers/admin/adminUserEdit.js"],"names":["React","useState","useEffect","getOneUser","updateUser","updatePassword","updateUserRole","getAllRoles","config","Header","HeaderPages","Footer","AdminMenu","Button","TextField","FormHelperText","FormControl","InputLabel","NativeSelect","makeStyles","AccountCircleIcon","MailIcon","AdminUserEdit","props","headerTitle","headerBreadcrumbs","value","link","firstName","setFirstName","firstNameError","setFirstNameError","firstNameErrorText","setFirstNameErrorText","lastName","setLastName","lastNameError","setLastNameError","lastNameErrorText","setLastNameErrorText","email","setEmail","emailError","setEmailError","emailErrorText","setEmailErrorText","password","setPassword","passwordUpdated","setPasswordUpdated","phone","setPhone","phoneError","setPhoneError","phoneErrorText","setPhoneErrorText","address","setAddress","zip","setZip","city","setCity","idSelectedRole","setIdSelectedRole","roles","setRoles","newRole","setNewRole","useStyles","theme","margin","spacing","width","classes","match","params","id","then","user","first_name","last_name","id_role","rolesDB","data","result","globalVerify","emailRegEx","phoneRegEx","datas","responseUpdateUser","status","console","log","datasPassword","responsePassword","parseInt","responseRole","onSubmit","e","target","label","InputLabelProps","shrink","map","role"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from \"react\"\nimport {getOneUser, updateUser, updatePassword, updateUserRole, getAllRoles} from \"../../api/user\"\nimport {config} from \"../../config/config\"\n\n//Imports des composants de l'UI externes\nimport Header from \"../headers/header\"\nimport HeaderPages from \"../headers/headerPages\"\nimport Footer from \"../footer\"\nimport AdminMenu from \"../../components/adminMenu\"\n\n//Imports depuis la librairie MaterialUI\nimport { Button } from '@material-ui/core';\nimport TextField from '@material-ui/core/TextField';\nimport FormHelperText from '@material-ui/core/FormHelperText';\nimport FormControl from '@material-ui/core/FormControl';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport NativeSelect from '@material-ui/core/NativeSelect';\nimport {makeStyles } from \"@material-ui/styles\";\nimport AccountCircleIcon from '@material-ui/icons/AccountCircle';\nimport MailIcon from '@material-ui/icons/Mail'\n\nconst AdminUserEdit = (props) => {\n    \n    const headerTitle = \"Administration\"\n    const headerBreadcrumbs = [{value: \"Accueil\", link:\"/\"},{value:\"Administration\", link:\"/admin\"},{value: \"Utilisateurs\", link:\"/admin/users\"},{value: \"Edition\", link:null}]\n\n    const [firstName, setFirstName] = useState(\"\")\n    const [firstNameError, setFirstNameError] = useState(false)\n    const [firstNameErrorText, setFirstNameErrorText] = useState(\"\")\n    \n\n    const [lastName, setLastName] = useState(\"\")\n    const [lastNameError, setLastNameError] = useState(false)\n    const [lastNameErrorText, setLastNameErrorText] = useState(\"\")\n\n    const [email, setEmail] = useState(\"\")\n    const [emailError, setEmailError] = useState(false)\n    const [emailErrorText, setEmailErrorText] = useState(\"\")\n\n    const [password, setPassword] = useState(\"\")\n    const [passwordUpdated, setPasswordUpdated] = useState(false)\n\n    const [phone, setPhone] = useState(\"\")\n    const [phoneError, setPhoneError] = useState(false)\n    const [phoneErrorText, setPhoneErrorText] = useState(\"\")\n\n    const [address, setAddress] = useState(\"\")\n    const [zip, setZip] = useState(\"\")\n    const [city, setCity] = useState(\"\")\n\n    const [idSelectedRole, setIdSelectedRole] = useState(\"\")\n\n    const [roles, setRoles] = useState([])\n    const [newRole, setNewRole] = useState(0)\n    \n    //Définition du style MaterialUI\n    const useStyles = makeStyles((theme) => ({\n        margin: {\n            margin: theme.spacing(1),\n            width: \"90%\"\n        },\n    }));\n\n    const classes = useStyles();\n\n    useEffect(() => {\n        getOneUser(props.match.params.id)\n        .then((user) => {\n            setFirstName(user.first_name)\n            setLastName(user.last_name)\n            setEmail(user.email)\n            setPhone(user.phone)\n            setAddress(user.address)\n            setZip(user.zip)\n            setCity(user.city)\n            setIdSelectedRole(user.id_role)\n            setNewRole(user.id_role)\n        })\n\n        getAllRoles()\n        .then(rolesDB => {\n            setRoles(rolesDB.data.result)\n        })\n    }, [props.match.params.id])\n\n    const globalVerify = () => {\n\n        if(!firstName){\n            setFirstNameError(true)\n            setFirstNameErrorText(\"Prénom non renseigné\")\n        }\n        else {\n            setFirstNameError(false)\n            setFirstNameErrorText(\"\")\n        }\n\n        if(!lastName){\n            setLastNameError(true)\n            setLastNameErrorText(\"Nom non renseigné\")\n        }\n        else {\n            setLastNameError(false)\n            setLastNameErrorText(\"\")\n        }\n        if(!email){\n            setEmailError(true)\n            setEmailErrorText(\"Adresse email non renseignée\")\n        }\n        else {\n            if(!email.match(config.emailRegEx)){\n                setEmailError(true)\n                setEmailErrorText(\"Adresse email non valide\")\n            }\n            else {\n                setEmailError(false)\n                setEmailErrorText(\"\")\n            }\n        }\n        if(password !== \"\"){\n            setPasswordUpdated(true)\n        }\n        else {\n            setPasswordUpdated(false)\n        }\n        if(!phone){\n            setPhoneError(true)\n            setPhoneErrorText(\"N° de téléphone non renseigné\")\n        }\n        else{\n            if(!phone.match(config.phoneRegEx)){\n                setPhoneError(true)\n                setPhoneErrorText(\"N° de téléphone incorrect\")\n            }\n            else {\n                setPhoneError(false)\n                setPhoneErrorText(\"\")\n            }\n        }\n\n        //Si tous les champs sont bons, on enregistre l'utilisateur\n        if(firstName && lastName && email && phone && phone.match(config.phoneRegEx) && email.match(config.emailRegEx)){\n            \n            let datas = {\n                first_name: firstName,\n                last_name: lastName,\n                email: email,\n                phone: phone,\n                address: address,\n                zip: zip,\n                city: city\n            }    \n\n            updateUser(datas, props.match.params.id)\n            .then(responseUpdateUser => {\n                if(responseUpdateUser.data.status === 200){\n                    console.log(\"Succès de la mise à jour utilisateur\")\n                    if(passwordUpdated){\n                        let datasPassword = {\n                            password: password\n                        }\n                        updatePassword(datasPassword, props.match.params.id)\n                        .then(responsePassword => { \n                            if(responsePassword.data.status === 200){\n                                console.log(\"Succès de la mise à jour du mot de passe\")\n                            }\n                            else {\n                                console.log(\"Erreur lors de la mise à jour du mot de passe\")\n                            }\n                        })\n                    }\n                    if(parseInt(newRole) !== idSelectedRole){\n                        let datas = {\n                            id_role: newRole\n                        }\n                        updateUserRole(datas, props.match.params.id)\n                        .then(responseRole => {\n                            if(responseRole.status === 200){\n                                console.log(\"Succès de la mise à jour du rôle\")\n                            } else {\n                                console.log(\"Erreur lors de la mise à jour du rôle\")\n                            }\n                        })\n                    }\n\n                    \n                }\n                else {\n                    console.log(\"Erreur lors de la mise à jour de l'utilisateur\")\n                }\n            })\n            \n        }\n        \n    }\n\n    const onSubmit = () => {\n        globalVerify()\n    }\n\n    return(\n        <section className=\"root\">\n                <Header />\n                <HeaderPages headerTitle={headerTitle} headerBreadcrumbs={headerBreadcrumbs}/>\n                <section className=\"admin-container\">\n                    <AdminMenu />\n\n                    <section className=\"admin-content\">\n                        <h4>Edition d'un utilisateur</h4>\n                        <section className=\"user-edit-container\">\n                            <form className=\"admin-user-edit\">\n                                <section className=\"user-edit-informations\">\n                                    <section className=\"user-edit-header\">\n                                        <p><AccountCircleIcon /></p>\n                                        <p className=\"admin-content-section-title\">Informations personnelles</p>\n                                    </section>\n                                    <section className=\"user-edit-informations-content\">\n                                        <FormControl error className={classes.margin}>\n                                            <TextField label=\"Nom\" color=\"primary\" required onChange={(e) => {setLastName(e.target.value)}} error={lastNameError} value={lastName || \"\"} variant=\"filled\"/>\n                                            <FormHelperText>{lastNameErrorText}</FormHelperText>\n                                        </FormControl>\n\n                                        <FormControl error className={classes.margin}>\n                                            <TextField label=\"Prénom\" color=\"primary\"  required onChange={(e) => {setFirstName(e.target.value)}} error={firstNameError} value={firstName || \"\"} variant=\"filled\"/>\n                                            <FormHelperText>{firstNameErrorText}</FormHelperText>\n                                        </FormControl>\n\n                                        <FormControl error className={classes.margin}>\n                                            <TextField label=\"Mot de passe\" color=\"primary\" onChange={(e) => {setPassword(e.target.value)\n                                            e.target.value ? setPasswordUpdated(true) : setPasswordUpdated(false)}} type=\"password\" defaultValue=\"\" variant=\"filled\"/>\n                                        </FormControl>\n\n                                        <FormControl className={classes.margin}>\n                                            <InputLabel shrink={true}>Rôle</InputLabel>\n                                            <NativeSelect\n                                            name=\"role\"\n                                            className=\"\"\n                                            textfieldprops={{\n                                                label: \"Label\",\n                                                InputLabelProps: {shrink:true}\n                                            }}\n                                            onChange={(e) => {\n                                                setNewRole(e.target.value)\n                                            }}>\n                                                {roles.map((role) => {\n                                                        return(<option value={role.id} key={role.id} selected={idSelectedRole === role.id ? true : false}>{role.label}</option>)\n                                                })}\n                                            </NativeSelect>\n                                        </FormControl>\n                                    </section>\n                                </section>\n                                <section className=\"user-edit-contact\">\n                                    <section className=\"user-edit-header\">\n                                        <p><MailIcon /></p>\n                                        <p className=\"admin-content-section-title\">Contact</p>\n                                    </section>\n                                    <section className=\"user-edit-contact-content\">\n                                        \n                                            <FormControl error className={classes.margin} >\n                                                <TextField label=\"Email\" color=\"primary\" required onChange={(e) => {setEmail(e.target.value)}} error={emailError} type=\"email\" value={email || \"\"} variant=\"filled\"/>\n                                                <FormHelperText>{emailErrorText}</FormHelperText>\n                                            </FormControl>\n\n                                            <FormControl error className={classes.margin}>\n                                                <TextField label=\"Téléphone\" color=\"primary\" required  error={phoneError} type=\"tel\" value={phone || \"\"\n                                                } onChange={(e) => {setPhone(e.target.value)}} variant=\"filled\"/>\n                                                <FormHelperText>{phoneErrorText}</FormHelperText>\n                                            </FormControl>\n\n                                            <FormControl error className={classes.margin}>\n                                                <TextField label=\"Adresse\" color=\"primary\" onChange={(e) => {setAddress(e.target.value)}} value={address || \"\"} variant=\"filled\"/>\n                                            </FormControl>\n\n                                            <FormControl error className={classes.margin}>\n                                                <TextField label=\"Code Postal\" color=\"primary\" onChange={(e) => {setZip(e.target.value)}} value={zip || \"\"} variant=\"filled\"/>\n                                            </FormControl>\n\n                                            <FormControl error className={classes.margin}>\n                                                <TextField label=\"Ville\" color=\"primary\" onChange={(e) => {setCity(e.target.value)}} value={city || \"\"} variant=\"filled\"/>\n                                            </FormControl>\n\n                                            \n                                    </section>\n                                    <Button className=\"admin-user-edit-button\" color=\"primary\" variant=\"contained\" onClick={(e)=>{onSubmit()}}>\n                                                Envoyer\n                                            </Button>\n                                </section>                          \n                            </form>\n                        </section>\n\n                    </section>\n                </section>\n                <Footer />\n        </section>\n    )\n}\n\nexport default AdminUserEdit"]},"metadata":{},"sourceType":"module"}